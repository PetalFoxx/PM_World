[
  {
    "id": "mon_prophet",
    "type": "MONSTER",
    "name": { "str": "<color_blue>Skin Prophet</color>" },
    "description": "The Skin Prophet is a maroon, emaciated humanoid with a bony body, a long spine, and a lumpy base instead of legs. It has three heads on long necks, each with a large, glowing orange eye with a red slit pupil. It has two arms holding a large book and a third arm with a fiery quill, constantly writing illegible glyphs described as future prophecies in the book.",
    "default_faction": "abnormalities",
    "bodytype": "human",
    "species": [ "ABNOS" ],
    "volume": "340 L",
    "weight": "210 kg",
    "hp": 348,
    "speed": 80,
    "material": [ "flesh" ],
    "looks_like": "mon_zombie_fireman",
    "symbol": "P",
    "color": "red",
    "aggression": 100,
    "morale": 100,
    "aggro_character": true,
    "melee_skill": 5,
    "melee_dice": 1,
    "melee_dice_sides": 6,
    "melee_damage": [ { "damage_type": "bash", "amount": 6 } ],
    "special_attacks": [
      {
        "id": "prophet_attack_light",
        "type": "spell",
        "spell_data": { "id": "p_light_attack", "min_level": 1 },
        "cooldown": 5,
        "monster_message": "%1$s burns you with a wave of his feather!"
      },
      {
        "id": "prophet_attack_light",
        "type": "spell",
        "spell_data": { "id": "p_marked", "min_level": 1 },
        "cooldown": 15,
        "monster_message": "%1$s draw a symbol in air then you head ring!"
      },
      {
        "id": "prophet_summon_fire_sphere_1",
        "type": "spell",
        "spell_data": { "id": "fire_sphere_spell_1", "min_level": 1 },
        "cooldown": 15,
        "monster_message": ""
      },
      {
        "id": "prophet_attack_powerful",
        "type": "spell",
        "spell_data": { "id": "prophet_powerful_short_spell", "min_level": 1 },
        "condition": { "math": [ "u_monsters_nearby('mon_candle_lit', 'radius': 60, 'attitude': 'friendly')", ">=", "1" ] },
        "cooldown": 10,
        "monster_message": ""
      }
    ],
    "dodge": 3,
    "grab_strength": 4,
    "weakpoint_sets": [ "wps_humanoid_body" ],
    "families": [ "prof_wp_abnos0", "prof_wp_abnos1", "prof_wp_abnos2" ],
    "vision_day": 50,
    "vision_night": 50,
    "harvest": "mutant_human",
    "flags": [
      "SEES",
      "HEARS",
      "PATH_AVOID_FALL",
      "PATH_AVOID_FIRE",
      "WARM",
      "ALWAYS_SEES_YOU",
      "CAN_OPEN_DOORS",
      "HAS_MIND",
      "IMMOBILE",
      "RANGED_ATTACKER",
      "ALWAYS_VISIBLE",
      "ALL_SEEING",
      "FIREY",
      "SILENT_DISAPPEAR",
      "ACIDPROOF"
    ],
    "death_function": { "effect": { "id": "death_prophet", "hit_self": true }, "message": "" },
    "armor": { "electric": 2, "heat": 100, "bash": 10, "cut": 8, "stab": 2, "bullet": 0, "acid": 10 }
  },
  {
    "id": "mon_candle",
    "type": "MONSTER",
    "name": { "str": "Candle" },
    "description": "Candle of prophet",
    "default_faction": "abnormalities",
    "bodytype": "blob",
    "species": [ "ABNOS" ],
    "volume": "340 L",
    "weight": "210 kg",
    "hp": 10,
    "speed": 0,
    "material": [ "paraffin_wax" ],
    "looks_like": "mon_zombie",
    "symbol": "I",
    "color": "white",
    "aggression": 100,
    "morale": 100,
    "aggro_character": true,
    "melee_skill": 5,
    "melee_dice": 1,
    "melee_dice_sides": 6,
    "melee_damage": [ { "damage_type": "bash", "amount": 6 } ],
    "dodge": 0,
    "flags": [ "IMMOBILE", "SILENT_DISAPPEAR", "ACIDPROOF" ],
    "death_function": { "effect": { "id": "candle_lit", "hit_self": true }, "corpse_type": "NO_CORPSE" },
    "armor": { "electric": 0, "heat": 100, "bash": 0, "cut": 0, "stab": 0, "bullet": 0, "acid": 10 }
  },
  {
    "id": "mon_candle_lit",
    "type": "MONSTER",
    "name": { "str": "Lit Candle" },
    "description": "Candle of prophet",
    "default_faction": "abnormalities",
    "bodytype": "blob",
    "species": [ "ABNOS" ],
    "volume": "340 L",
    "weight": "210 kg",
    "hp": 10,
    "speed": 0,
    "material": [ "paraffin_wax" ],
    "looks_like": "mon_zombie_nullfield",
    "symbol": "i",
    "color": "white",
    "aggression": 100,
    "morale": 100,
    "aggro_character": true,
    "melee_skill": 0,
    "melee_dice": 0,
    "melee_dice_sides": 0,
    "melee_damage": [ { "damage_type": "bash", "amount": 0 } ],
    "dodge": 0,
    "flags": [ "IMMOBILE", "FIREY", "SILENT_DISAPPEAR", "ACIDPROOF" ],
    "death_function": { "effect": { "id": "candle_ext", "hit_self": true }, "corpse_type": "NO_CORPSE" },
    "armor": { "electric": 0, "heat": 100, "bash": 0, "cut": 0, "stab": 0, "bullet": 0, "acid": 10 }
  },
  {
    "id": "fire_sphere_spell_1",
    "type": "SPELL",
    "name": { "str": "Fire sphere (first phase)" },
    "description": "Summons a Fire sphere (phase 1) around the player",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "summon",
    "effect_str": "mon_fire_sphere_1",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_range": 60,
    "max_range": 60,
    "min_aoe": 1,
    "max_aoe": 1,
    "min_duration": 400,
    "max_duration": 500,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_FAIL", "NO_HANDS", "NO_LEGS", "HOSTILE_SUMMON", "RANDOM_DURATION" ]
  },
  {
    "id": "mon_fire_sphere_1",
    "type": "MONSTER",
    "name": { "str": "Fire sphere" },
    "description": "",
    "default_faction": "abnormalities",
    "bodytype": "blob",
    "species": [ "ABNOS" ],
    "volume": "1000 ml",
    "weight": "1 g",
    "hp": 9,
    "speed": 0,
    "material": [ "steel" ],
    "looks_like": "fd_fire",
    "symbol": "o",
    "color": "red",
    "aggression": 0,
    "morale": 100,
    "melee_skill": 0,
    "melee_dice": 0,
    "melee_dice_sides": 0,
    "dodge": 0,
    "flags": [ "FIREY", "ACIDPROOF", "SEES" ],
    "vision_day": 6,
    "vision_night": 6,
    "path_settings": { "max_dist": 6 },
    "special_attacks": [
      {
        "id": "fire_sphere_1_explosion",
        "type": "spell",
        "spell_data": { "id": "fire_sphere_1_explosion_spell", "min_level": 1 },
        "cooldown": 1,
        "allow_no_target": true,
        "monster_message": ""
      }
    ],
    "death_function": { "effect": { "id": "death_conflagration", "hit_self": true } },
    "armor": { "electric": 0, "heat": 100, "bash": 0, "cut": 0, "stab": 0, "bullet": 0, "acid": 10 },
    "//": "This monster instantly casts fire_sphere_1_explosion_spell , which runs the EOC that activates the explosion (death_fire_sphere_1) in 5 s",
    "//2": "If the monster is killed it immediately casts the final explosion (death_fire_sphere_1) as death effect"
  },
  {
    "id": "fire_sphere_1_explosion_spell",
    "type": "SPELL",
    "name": { "str": "Fire sphere (first phase) (Spell-to-EOC)" },
    "description": "Spell intermediate that runs the EOC",
    "flags": [ "NO_EXPLOSION_SFX", "SILENT", "NO_PROJECTILE", "NON_MAGICAL", "IGNORE_WALLS" ],
    "valid_targets": [ "self" ],
    "base_casting_time": 0,
    "shape": "blast",
    "range_increment": 2,
    "effect": "effect_on_condition",
    "effect_str": "fire_sphere_1_explosion_spell_eoc"
  },
  {
    "id": "fire_sphere_1_explosion_spell_eoc",
    "type": "effect_on_condition",
    "effect": [
      { "queue_eocs": [ "fire_sphere_1_explosion_spell_eoc_2" ], "time_in_future": "3 s" }
    ]
  },
  {
    "id": "fire_sphere_1_explosion_spell_eoc_2",
    "type": "effect_on_condition",
    "effect": [
      { "u_cast_spell": { "id": "death_conflagration" } }
    ]
  },
  {
    "id": "death_conflagration",
    "type": "SPELL",
    "name": { "str": "Fire sphere (first phase) (explosion)" },
    "valid_targets": [ "self", "ally", "hostile", "ground" ],
    "description": "Explosion for mon_fire_sphere_1 ",
    "effect": "attack",
    "min_aoe": 3,
    "max_aoe": 4,
    "min_damage": 12,
    "max_damage": 16,
    "damage_type": "heat",
    "shape": "blast",
    "flags": [ "IGNITE_FLAMMABLE", "RANDOM_AOE", "RANDOM_DAMAGE" ]
  },
  {
    "id": "prophet_powerful_short_spell",
    "type": "SPELL",
    "name": "Powerful short spell",
    "description": "Deals random, heavy damage around the prophet, hostiles (plus ground) only, random radius",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": 24,
    "max_damage": 36,
    "min_aoe": 4,
    "max_aoe": 5,
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "IGNITE_FLAMMABLE", "NO_FAIL", "SOMATIC", "RANDOM_AOE", "RANDOM_DAMAGE" ]
  },
  {
    "id": "death_prophet",
    "type": "SPELL",
    "name": { "str": "Prophet death" },
    "description": "Death effect for mon_prophet , summons mon_prophet_2 ",
    "effect": "summon",
    "effect_str": "mon_prophet_2",
    "valid_targets": [ "ground", "self" ],
    "shape": "blast",
    "message": "",
    "damage_type": "pure",
    "min_damage": 1,
    "max_damage": 1,
    "min_aoe": 6,
    "max_aoe": 6,
    "flags": [ "HOSTILE_SUMMON", "PERMANENT", "SILENT", "SPAWN_WITH_DEATH_DROPS" ]
  },
  {
    "//note": "Copied from mon_prophet , except for its special_attacks and death_function ",
    "id": "mon_prophet_2",
    "type": "MONSTER",
    "name": { "str": "<color_blue>Skin Prophet</color>" },
    "description": "The Skin Prophet is a maroon, emaciated humanoid with a bony body, a long spine, and a lumpy base instead of legs. It has three heads on long necks, each with a large, glowing orange eye with a red slit pupil. It has two arms holding a large book and a third arm with a fiery quill, constantly writing illegible glyphs described as future prophecies in the book.",
    "default_faction": "abnormalities",
    "bodytype": "human",
    "species": [ "ABNOS" ],
    "volume": "340 L",
    "weight": "210 kg",
    "hp": 348,
    "speed": 80,
    "material": [ "flesh" ],
    "looks_like": "mon_prophet",
    "symbol": "P",
    "color": "red",
    "aggression": 100,
    "morale": 100,
    "aggro_character": true,
    "melee_skill": 5,
    "melee_dice": 1,
    "melee_dice_sides": 6,
    "melee_damage": [ { "damage_type": "bash", "amount": 6 } ],
    "special_attacks": [
      {
        "id": "prophet_2_attack_light",
        "type": "spell",
        "spell_data": { "id": "p_2_light_attack", "min_level": 1 },
        "cooldown": 5,
        "monster_message": ""
      },
      {
        "id": "prophet_2_attack_fire_sphere",
        "type": "spell",
        "spell_data": { "id": "fire_sphere_spell_2", "min_level": 1 },
        "cooldown": 15,
        "monster_message": ""
      },
      {
        "id": "prophet_2_attack_scatter_v1",
        "type": "spell",
        "spell_data": { "id": "p_2_scatter_spell_v1", "min_level": 1 },
        "cooldown": 10,
        "monster_message": ""
      },
      {
        "id": "prophet_2_attack_scatter_v2",
        "type": "spell",
        "spell_data": { "id": "p_2_scatter_spell_v2", "min_level": 1 },
        "cooldown": 10,
        "monster_message": ""
      }
    ],
    "dodge": 3,
    "grab_strength": 4,
    "weakpoint_sets": [ "wps_humanoid_body" ],
    "families": [ "prof_wp_abnos0", "prof_wp_abnos1", "prof_wp_abnos2" ],
    "vision_day": 50,
    "vision_night": 50,
    "harvest": "mutant_human",
    "flags": [
      "SEES",
      "HEARS",
      "PATH_AVOID_FALL",
      "PATH_AVOID_FIRE",
      "WARM",
      "ALWAYS_SEES_YOU",
      "CAN_OPEN_DOORS",
      "HAS_MIND",
      "IMMOBILE",
      "RANGED_ATTACKER",
      "ALWAYS_VISIBLE",
      "ALL_SEEING",
      "FIREY",
      "SILENT_DISAPPEAR",
      "ACIDPROOF"
    ],
    "death_function": { "corpse_type": "NORMAL", "message": "" },
    "armor": { "electric": 2, "heat": 100, "bash": 10, "cut": 8, "stab": 2, "bullet": 0, "acid": 10 }
  },
  {
    "id": "p_2_light_attack",
    "type": "SPELL",
    "name": "Prophet light attack (second phase)",
    "description": "Light attack for mon_prophet_2 , deals between p_light_attack and ( p_light_attack * 2 ) special dmg ",
    "valid_targets": [ "hostile", "ground" ],
    "effect": "attack",
    "damage_type": "prophet_heat",
    "min_damage": { "math": [ "( 2 + 2 * ( u_effect_intensity('p_gaze') ) )" ] },
    "max_damage": { "math": [ "( 4 + 4 * ( u_effect_intensity('p_gaze') ) )" ] },
    "damage_increment": 0,
    "base_casting_time": 0,
    "min_range": 10,
    "max_range": 10,
    "range_increment": 2,
    "shape": "blast",
    "flags": [ "IGNITE_FLAMMABLE", "NO_FAIL", "NON_MAGICAL", "RANDOM_DAMAGE" ],
    "energy_source": "NONE"
  },
  {
    "id": "firefeather_item",
    "type": "TOOL",
    "name": { "str": "fire feather", "str_pl": "fire feathers" },
    "description": "A fire feather.  This will protect you.",
    "volume": "1 ml",
    "weight": "1 g",
    "longest_side": "5 cm",
    "price_postapoc": 25000,
    "to_hit": { "balance": "neutral", "grip": "bad", "length": "hand", "surface": "any" },
    "melee_damage": { "bash": 1 },
    "material": [ "steel" ],
    "symbol": "f",
    "looks_like": "feather",
    "color": "light_red",
    "relic_data": { "passive_effects": [ { "has": "HELD", "condition": "ALWAYS", "mutations": [ "FIREFEATHER_MUT" ] } ] },
    "flags": [ "TRADER_AVOID" ]
  },
  {
    "id": "FIREFEATHER_MUT",
    "type": "mutation",
    "name": "Fire feather protection",
    "description": "",
    "points": 0,
    "profession": true,
    "purifiable": false,
    "starting_trait": false,
    "valid": false
  },
  {
    "id": "firefeather_check",
    "type": "effect_on_condition",
    "recurrence": "1 s",
    "condition": {
      "and": [
        { "u_has_trait": "FIREFEATHER_MUT" },
        { "not": { "u_has_item": "firefeather_item" } }
      ]
    },
    "deactivate_condition": { "not": { "u_has_item": "firefeather_item" } },
    "effect": [ 
      { "u_lose_trait": "FIREFEATHER_MUT" }
    ],
    "//": "This removes the protection granted by firefeather_item "
  },
  {
    "id": "fire_sphere_spell_2",
    "type": "SPELL",
    "name": { "str": "Fire sphere (second phase)" },
    "description": "Summons a Fire sphere (phase 2) around the player",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "summon",
    "effect_str": "mon_fire_sphere_2",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_range": 60,
    "max_range": 60,
    "min_aoe": 1,
    "max_aoe": 1,
    "min_duration": 100,
    "max_duration": 100,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_FAIL", "NO_HANDS", "NO_LEGS", "HOSTILE_SUMMON" ]
  },
  {
    "//note": "Copied from mon_fire_sphere_1 , except for its special_attacks and death_function ",
    "id": "mon_fire_sphere_2",
    "type": "MONSTER",
    "name": { "str": "Fire sphere" },
    "description": "",
    "default_faction": "abnormalities",
    "bodytype": "blob",
    "species": [ "ABNOS" ],
    "volume": "1000 ml",
    "weight": "1 g",
    "hp": 9,
    "speed": 0,
    "material": [ "steel" ],
    "looks_like": "mon_fire_sphere_1",
    "symbol": "o",
    "color": "red",
    "aggression": 0,
    "morale": 100,
    "melee_skill": 0,
    "melee_dice": 0,
    "melee_dice_sides": 0,
    "dodge": 0,
    "vision_day": 6,
    "vision_night": 6,
    "path_settings": { "max_dist": 6 },
    "flags": [ "FIREY", "ACIDPROOF", "SEES" ],
    "special_attacks": [
      {
        "id": "fire_sphere_2_explosion",
        "type": "spell",
        "spell_data": { "id": "death_fire_sphere_2", "min_level": 1 },
        "cooldown": 1,
        "allow_no_target": true,
        "monster_message": ""
      }
    ],
    "death_function": { "effect": { "id": "death_conflagration", "hit_self": true } },
    "armor": { "electric": 0, "heat": 100, "bash": 0, "cut": 0, "stab": 0, "bullet": 0, "acid": 10 },
    "//": "This monster instantly casts death_fire_sphere_2 "
  },
  {
    "id": "death_fire_sphere_2",
    "type": "SPELL",
    "name": { "str": "Fire sphere (second phase) (explosion)" },
    "description": "Explosion for mon_fire_sphere_2 ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile", "self" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": 16,
    "max_damage": 24,
    "min_pierce": 0,
    "max_pierce": 0,
    "min_aoe": 4,
    "max_aoe": 6,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "IGNITE_FLAMMABLE", "NO_FAIL", "NO_PROJECTILE", "RANDOM_AOE", "RANDOM_DAMAGE" ]
  },
  {
    "id": "p_2_scatter_spell_v1",
    "type": "SPELL",
    "name": { "str": "Scatter spell (v1, summons monster)" },
    "description": "Scatter spell, version 1. This summons monsters that explode",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "summon",
    "effect_str": "mon_scatter_v1",
    "shape": "blast",
    "min_damage": 7,
    "max_damage": 11,
    "min_range": 60,
    "max_range": 60,
    "min_aoe": 4,
    "max_aoe": 4,
    "min_duration": 500,
    "max_duration": 500,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_FAIL", "NO_HANDS", "NO_LEGS", "RANDOM_DAMAGE", "HOSTILE_SUMMON" ]
  },
  {
    "id": "mon_scatter_v1",
    "type": "MONSTER",
    "name": { "str": "" },
    "description": "",
    "default_faction": "abnormalities",
    "bodytype": "blob",
    "species": [ "ABNOS" ],
    "volume": "1000 ml",
    "weight": "1 g",
    "hp": 9,
    "speed": 0,
    "material": [ "steel" ],
    "looks_like": "fd_fire",
    "symbol": "o",
    "color": "red",
    "aggression": 0,
    "morale": 100,
    "melee_skill": 0,
    "melee_dice": 0,
    "melee_dice_sides": 0,
    "dodge": 0,
    "vision_day": 6,
    "vision_night": 6,
    "path_settings": { "max_dist": 6 },
    "flags": [ "IMMOBILE", "FIREY", "ACIDPROOF", "SEES" ],
    "special_attacks": [
      {
        "id": "scatter_v1_explosion",
        "type": "spell",
        "spell_data": { "id": "death_scatter_v1", "min_level": 1 },
        "cooldown": 1,
        "allow_no_target": true,
        "monster_message": ""
      }
    ],
    "death_function": { "effect": { "id": "death_conflagration", "hit_self": true } },
    "armor": { "electric": 0, "heat": 100, "bash": 0, "cut": 0, "stab": 0, "bullet": 0, "acid": 10 },
    "//": "This monster instantly casts death_scatter_v1 , it also casts it if it dies"
  },
  {
    "id": "death_scatter_v1",
    "type": "SPELL",
    "name": { "str": "Scatter death (explosion)" },
    "description": "Explosion for mon_scatter_v1 ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile", "self" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": 16,
    "max_damage": 24,
    "min_aoe": 1,
    "max_aoe": 2,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "IGNITE_FLAMMABLE", "NO_FAIL", "NO_PROJECTILE", "RANDOM_AOE", "RANDOM_DAMAGE" ]
  },
  {
    "id": "p_2_scatter_spell_v2",
    "type": "SPELL",
    "name": { "str": "Scatter spell (v2, summons traps)" },
    "description": "Scatter spell, version 2. This summons traps that explode",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "ter_transform",
    "effect_str": "scatter_trap",
    "shape": "blast",
    "min_range": 60,
    "max_range": 60,
    "min_aoe": 8,
    "max_aoe": 8,
    "min_duration": 6000,
    "max_duration": 6000,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_FAIL", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ]
  },
  {
    "id": "scatter_trap",
    "type": "ter_furn_transform",
    "trap": [
      {
        "valid_flags": [  ], 
        "result": "tr_scatter_v2", 
        "message": "" 
      }
    ]
  },
  {
    "id": "tr_scatter_v2",
    "type": "trap",
    "name": "",
    "symbol": "#",
    "color": "red",
    "visibility": 0,
    "avoidance": 8,
    "difficulty": 99,
    "trap_radius": 1,
    "action": "spell",
    "spell_data": { "id": "death_scatter_v1_explosion" }
  }
]
